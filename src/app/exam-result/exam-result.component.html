<app-second-nav></app-second-nav>

<section class="container my-4">
  <h1>{{ 'examResult.title' | transloco }}: {{ quiz.quizTitle }}</h1>
<div class="exam-summary-card">
  <div class="exam-summary-item">
    <strong>{{ 'examResult.status' | transloco }}:</strong>
    <span [ngClass]="isPassed ? 'status-pass' : 'status-fail'">
      {{ isPassed ? ('examResult.passed' | transloco) : ('examResult.failed' | transloco) }}
    </span>
  </div>
  <div class="exam-summary-item">
    <strong>{{ 'examResult.timeUsed' | transloco }}:</strong> {{ timeUsed }}
  </div>
  <div class="exam-summary-item">
    <strong>{{ 'examResult.totalQuestions' | transloco }}:</strong> {{ totalQuestions }}
  </div>
  <div class="exam-summary-item">
    <strong>{{ 'examResult.correctAnswers' | transloco }}:</strong> {{ correctAnswers }}
  </div>
  <div class="exam-summary-item">
    <strong>{{ 'examResult.unanswered' | transloco }}:</strong> {{ unanswered }}
  </div>
  <div class="exam-summary-item">
    <strong>{{ 'examResult.percentage' | transloco }}:</strong> {{ percentage }}%
  </div>
</div>


  <div *ngFor="let section of structuredQuestions">
    <h2>  {{ 'examResult.sectionTitle' | transloco }}  : {{ section.title }}</h2>

    <div *ngFor="let item of section.contentItems" class="lecture-box">
      <!-- üü¢ ÿπŸÜŸàÿßŸÜ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ -->
     <h3>
  <ng-container *ngIf="isTitleObject(item.title); else titleString">
    <ng-container [ngSwitch]="item.title.type">
      <span *ngSwitchCase="'lecture'">
        {{ 'examResult.lecture' | transloco }}: {{ item.title.name }}
      </span>
      <span *ngSwitchCase="'subSection'">
        {{ 'examResult.subSection' | transloco }}: {{ item.title.name }}
      </span>
      <span *ngSwitchCase="'subSectionLecture'">
        {{ 'examResult.subSectionLecture' | transloco }}: {{ item.title.parent }} - {{ item.title.name }}
      </span>
      <span *ngSwitchCase="'sectionQuestions'">
        {{ 'examResult.sectionQuestions' | transloco }}
      </span>
      <span *ngSwitchCase="'general'">
        {{ 'examResult.general' | transloco }}
      </span>
    </ng-container>
  </ng-container>

  <!-- fallback ŸÑŸà ÿßŸÑÿπŸÜŸàÿßŸÜ ŸÖÿ¨ÿ±ÿØ ŸÜÿµ -->
  <ng-template #titleString>
    {{ item.title }}
  </ng-template>
</h3>



<p *ngIf="isTitleObject(item.title)" style="margin: 0 0 8px 0; font-weight: bold;">
  {{ item.title.name }}
</p>

      <p style="font-size: 14px; color: gray; margin-bottom: 15px;">
        {{ 'examResult.totalQuestions' | transloco }}: {{ item.questions.length }} |
        {{ 'examResult.answeredQuestions' | transloco }}: {{ getAnsweredCount(item.questions) }}
      </p>

      <div *ngFor="let question of item.questions" class="question-box" style="margin-bottom: 20px;">
        <p>
          <strong>{{ 'examResult.question' | transloco }}:</strong> {{ question.text }}
          <span *ngIf="question.isUnique" style="color: orange">‚≠ê {{ 'examResult.featured' | transloco }}</span>
        </p>

        <!-- ‚úÖ ÿßÿÆÿ™Ÿäÿßÿ± ŸÖŸÜ ŸÖÿ™ÿπÿØÿØ -->
        <ul *ngIf="quizType === 1">
          <li
            *ngFor="let option of question.choices || question.options; let i = index"
            [ngClass]="{
              'correct-answer': option.text === question.modelAnswer,
              'wrong-answer': option.text === question.studentAnswer && option.text !== question.modelAnswer,
              'student-answer': option.text === question.studentAnswer
            }"
          >
            {{ getOptionLetter(i) }}) {{ option.text }}
            <span *ngIf="option.text === question.modelAnswer">‚úîÔ∏è</span>
            <span *ngIf="option.text === question.studentAnswer && option.text !== question.modelAnswer">‚ùå</span>
            <span *ngIf="option.text === question.studentAnswer">üë§</span>
          </li>
        </ul>

        <!-- üìù ÿ≥ÿ§ÿßŸÑ ŸÖŸÇÿßŸÑŸä -->
        <div *ngIf="quizType === 2">
          <p>
            <strong>{{ 'examResult.studentAnswer' | transloco }}:</strong>
            <span class="icon-user">üë§</span>
            {{ question.studentAnswer || ('examResult.noAnswer' | transloco) }}
          </p>
          <p>
            <strong>{{ 'examResult.modelAnswer' | transloco }}:</strong>
            <span class="correct-answer">‚úîÔ∏è</span>
            {{ question.modelAnswer }}
          </p>
        </div>
      </div>
    </div>
  </div>

  <ng-template #noData>
    <p>{{ 'examResult.noData' | transloco }}</p>
  </ng-template>
</section>
